<UserControl x:Class="TaskMaster.Views.TaskListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:TaskMaster.ViewModels">
    <UserControl.DataContext>
        <vm:TaskListViewModel/>
    </UserControl.DataContext>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Filter Controls -->
        <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Column="0" Content="Status:" VerticalAlignment="Center"/>
                <ComboBox Grid.Column="1" SelectedValue="{Binding StatusFilter}" VerticalAlignment="Center" Margin="0,0,10,0">
                    <ComboBoxItem Content="All" IsSelected="True"/>
                    <ComboBoxItem Content="Todo"/>
                    <ComboBoxItem Content="InProgress"/>
                    <ComboBoxItem Content="Done"/>
                    <ComboBoxItem Content="Cancelled"/>
                </ComboBox>

                <Label Grid.Column="2" Content="Type:" VerticalAlignment="Center"/>
                <ComboBox Grid.Column="3" SelectedValue="{Binding TypeFilter}" VerticalAlignment="Center" Margin="0,0,10,0">
                    <ComboBoxItem Content="All" IsSelected="True"/>
                    <ComboBoxItem Content="feature"/>
                    <ComboBoxItem Content="bug"/>
                    <ComboBoxItem Content="enhancement"/>
                    <ComboBoxItem Content="refactor"/>
                    <ComboBoxItem Content="docs"/>
                </ComboBox>

                <Button Grid.Column="5" Content="Refresh" Command="{Binding RefreshTasksCommand}"
                        VerticalAlignment="Center" MinWidth="80"/>
            </Grid>
        </Border>

        <!-- Task List -->
        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredTasks}" SelectedItem="{Binding SelectedTask}"
                  AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
                  GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                  SelectionMode="Single" IsReadOnly="True"
                  AlternatingRowBackground="#F9F9F9">
            <DataGrid.Columns>
                <DataGridTextColumn Header="#" Binding="{Binding Number}" Width="50"/>
                <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="*" MinWidth="200"/>
                <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                <DataGridTextColumn Header="Created" Binding="{Binding Created, StringFormat='yyyy-MM-dd'}" Width="100"/>
            </DataGrid.Columns>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Status}" Value="Done">
                            <Setter Property="Foreground" Value="Green"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Status}" Value="InProgress">
                            <Setter Property="Foreground" Value="Blue"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Status}" Value="Cancelled">
                            <Setter Property="Foreground" Value="Gray"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>

        <!-- Pagination Controls -->
        <Border Grid.Row="2" Background="#F8F8F8" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding TaskCountText}" VerticalAlignment="Center" Margin="0,0,20,0"/>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="◀◀" Command="{Binding FirstPageCommand}" Width="30" Margin="0,0,5,0"/>
                    <Button Content="◀" Command="{Binding PreviousPageCommand}" Width="30" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding CurrentPage}" VerticalAlignment="Center" Margin="10,0"/>
                    <TextBlock Text="of" VerticalAlignment="Center" Margin="5,0"/>
                    <TextBlock Text="{Binding TotalPages}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Button Content="▶" Command="{Binding NextPageCommand}" Width="30" Margin="5,0"/>
                    <Button Content="▶▶" Command="{Binding LastPageCommand}" Width="30" Margin="5,0,0,0"/>
                </StackPanel>

                <ComboBox Grid.Column="4" SelectedValue="{Binding PageSize}" VerticalAlignment="Center" Width="80" Margin="10,0,0,0">
                    <ComboBoxItem Content="10"/>
                    <ComboBoxItem Content="25" IsSelected="True"/>
                    <ComboBoxItem Content="50"/>
                    <ComboBoxItem Content="100"/>
                </ComboBox>
            </Grid>
        </Border>
    </Grid>
</UserControl>