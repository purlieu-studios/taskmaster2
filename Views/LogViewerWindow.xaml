<Window x:Class="TaskMaster.Views.LogViewerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TaskMaster - Log Viewer" Height="700" Width="1200"
        WindowStartupLocation="CenterOwner"
        Background="#0F1419">

    <Window.Resources>
        <!-- Design System Colors -->
        <SolidColorBrush x:Key="CardBackground" Color="#1A1F2E"/>
        <SolidColorBrush x:Key="ElevatedSurface" Color="#252A37"/>
        <SolidColorBrush x:Key="BorderColor" Color="#3A3F4B"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#F9FAFB"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#D1D5DB"/>
        <SolidColorBrush x:Key="TextMuted" Color="#9CA3AF"/>

        <!-- Log Level Colors -->
        <SolidColorBrush x:Key="TraceColor" Color="#6B7280"/>
        <SolidColorBrush x:Key="DebugColor" Color="#60A5FA"/>
        <SolidColorBrush x:Key="InfoColor" Color="#34D399"/>
        <SolidColorBrush x:Key="WarningColor" Color="#FBBF24"/>
        <SolidColorBrush x:Key="ErrorColor" Color="#F87171"/>
        <SolidColorBrush x:Key="CriticalColor" Color="#DC2626"/>

        <!-- Gradient Brushes -->
        <LinearGradientBrush x:Key="PurplePinkGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#7C3AED" Offset="0"/>
            <GradientStop Color="#EC4899" Offset="1"/>
        </LinearGradientBrush>

        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource ElevatedSurface}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" TargetName="border" Value="#7C3AED"/>
                                <Setter Property="Background" TargetName="border" Value="#2D3748"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" TargetName="border" Value="#374151"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button Style -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PurplePinkGradient}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern TextBox Style -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource ElevatedSurface}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false"
                                        HorizontalScrollBarVisibility="Hidden"
                                        VerticalScrollBarVisibility="Hidden"
                                        Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" TargetName="border" Value="#7C3AED"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" TargetName="border" Value="#EC4899"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- CheckBox Style -->
        <Style x:Key="ModernCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,0,12,0"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with Filters -->
        <Border Grid.Row="0" Background="{StaticResource CardBackground}"
                BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Title -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                    <TextBlock Text="ðŸ“Š" FontSize="24" Margin="0,0,8,0" VerticalAlignment="Center"/>
                    <TextBlock Text="Log Viewer" FontSize="20" FontWeight="Bold"
                              Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="LogCountText" Text="" FontSize="14"
                              Foreground="{StaticResource TextMuted}" Margin="16,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Log Level Filters -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Levels:" Foreground="{StaticResource TextSecondary}"
                              FontSize="13" FontWeight="Medium" Margin="0,0,12,0" VerticalAlignment="Center"/>
                    <CheckBox x:Name="TraceCheckBox" Content="Trace" Style="{StaticResource ModernCheckBox}"
                             Foreground="{StaticResource TraceColor}" Checked="FilterChanged" Unchecked="FilterChanged"/>
                    <CheckBox x:Name="DebugCheckBox" Content="Debug" Style="{StaticResource ModernCheckBox}"
                             Foreground="{StaticResource DebugColor}" IsChecked="True" Checked="FilterChanged" Unchecked="FilterChanged"/>
                    <CheckBox x:Name="InfoCheckBox" Content="Info" Style="{StaticResource ModernCheckBox}"
                             Foreground="{StaticResource InfoColor}" IsChecked="True" Checked="FilterChanged" Unchecked="FilterChanged"/>
                    <CheckBox x:Name="WarningCheckBox" Content="Warning" Style="{StaticResource ModernCheckBox}"
                             Foreground="{StaticResource WarningColor}" IsChecked="True" Checked="FilterChanged" Unchecked="FilterChanged"/>
                    <CheckBox x:Name="ErrorCheckBox" Content="Error" Style="{StaticResource ModernCheckBox}"
                             Foreground="{StaticResource ErrorColor}" IsChecked="True" Checked="FilterChanged" Unchecked="FilterChanged"/>
                    <CheckBox x:Name="CriticalCheckBox" Content="Critical" Style="{StaticResource ModernCheckBox}"
                             Foreground="{StaticResource CriticalColor}" IsChecked="True" Checked="FilterChanged" Unchecked="FilterChanged"/>
                </StackPanel>

                <!-- Search and Context Filters -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Search Box -->
                    <TextBox x:Name="SearchTextBox" Grid.Column="0" Style="{StaticResource ModernTextBox}"
                            Text="" TextChanged="SearchTextChanged"/>

                    <TextBlock Grid.Column="1" Text="Context:" Foreground="{StaticResource TextSecondary}"
                              FontSize="13" Margin="12,0,8,0" VerticalAlignment="Center"/>

                    <!-- Context Filter -->
                    <ComboBox x:Name="ContextComboBox" Grid.Column="2" Background="{StaticResource ElevatedSurface}"
                             Foreground="{StaticResource TextPrimary}" BorderBrush="{StaticResource BorderColor}"
                             SelectionChanged="FilterChanged">
                        <ComboBoxItem Content="All Contexts"/>
                    </ComboBox>

                    <!-- Auto-refresh Toggle -->
                    <CheckBox x:Name="AutoRefreshCheckBox" Grid.Column="3" Content="Auto-refresh"
                             Style="{StaticResource ModernCheckBox}" Margin="16,0,0,0"
                             IsChecked="True" Checked="AutoRefreshChanged" Unchecked="AutoRefreshChanged"/>
                </Grid>
            </Grid>
        </Border>

        <!-- Log Entries List -->
        <ListView x:Name="LogEntriesListView" Grid.Row="1"
                 Background="{StaticResource CardBackground}"
                 BorderThickness="0"
                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                 SelectionChanged="LogEntrySelected">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Time" Width="140">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Timestamp, StringFormat=HH:mm:ss.fff}"
                                          Foreground="{StaticResource TextSecondary}" FontFamily="Consolas" FontSize="11"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Level" Width="80">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Border CornerRadius="3" Padding="4,2" HorizontalAlignment="Center">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Level}" Value="Verbose">
                                                    <Setter Property="Background" Value="{StaticResource TraceColor}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Debug">
                                                    <Setter Property="Background" Value="{StaticResource DebugColor}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Information">
                                                    <Setter Property="Background" Value="{StaticResource InfoColor}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Warning">
                                                    <Setter Property="Background" Value="{StaticResource WarningColor}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Error">
                                                    <Setter Property="Background" Value="{StaticResource ErrorColor}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Fatal">
                                                    <Setter Property="Background" Value="{StaticResource CriticalColor}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="{Binding Level}" Foreground="White" FontSize="10" FontWeight="Bold"/>
                                </Border>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Context" Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Context}" Foreground="{StaticResource TextMuted}" FontSize="11"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Message" Width="600">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Message}" Foreground="{StaticResource TextPrimary}"
                                          FontSize="12" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Details Panel -->
        <Border Grid.Row="2" Background="{StaticResource ElevatedSurface}"
                BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0"
                MinHeight="200" MaxHeight="300">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel>
                        <TextBlock Text="Log Entry Details" FontSize="14" FontWeight="Bold"
                                  Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12"/>
                        <TextBox x:Name="DetailsTextBox" Style="{StaticResource ModernTextBox}"
                                IsReadOnly="True" AcceptsReturn="True" TextWrapping="Wrap"
                                VerticalScrollBarVisibility="Auto" MinHeight="150" FontFamily="Consolas" FontSize="11"/>
                    </StackPanel>
                </ScrollViewer>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="1" Orientation="Vertical" Margin="16" VerticalAlignment="Top">
                    <Button Content="ðŸ”„ Refresh" Style="{StaticResource ModernButton}" Click="RefreshClicked" Margin="0,0,0,8"/>
                    <Button Content="ðŸ“‹ Copy Entry" Style="{StaticResource ModernButton}" Click="CopyEntryClicked" Margin="0,0,0,8"/>
                    <Button Content="ðŸ“‹ Copy All" Style="{StaticResource ModernButton}" Click="CopyAllClicked" Margin="0,0,0,8"/>
                    <Button Content="ðŸ’¾ Export Logs" Style="{StaticResource PrimaryButton}" Click="ExportLogsClicked" Margin="0,0,0,8"/>
                    <Button Content="ðŸ“¦ Debug Package" Style="{StaticResource PrimaryButton}" Click="ExportDebugPackageClicked" Margin="0,0,0,8"/>
                    <Button Content="ðŸ—‘ï¸ Clear" Style="{StaticResource ModernButton}" Click="ClearClicked"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>